\section{System overview}

Heart of SoC is CPU. The CPU is only one master on the system bus and it control
all communication on this bus. To the CPU is directly connected interrupt
controller.

Bus consist of 24b address, 32b MOSI data, 32b MISO data, clock, reset, write,
read and ack signals. There is also 32b bus for interrupts.

All the peripherals are connected to the system bus, CPU select peripheral to
communicate with through address. Peripheral control ack signal to say to CPU
"data is ready for read" when CPU want read data, or "data is written" when CPU
want write data. This allow slower peripheral to cooperate with CPU, CPU simply
wait for them.

Some peripherals have special pins, these are commonly connected to the top
level entity pins, but there are few that are connected internally, for example
pll outputs.

CPU have multiple clock domain. At this moment there are two domains, one is for
VGA pixel clock and another is for rest SoC (CPU/Timers/UARTs and so on).
Clocks are generated by pll from 50MHz input. 50MHz was selected because 50MHz
oscillators are common on the Terasic FPGA boards.

\begin{wrapfigure}{L}{0.6\textwidth}
    \centering
    \includegraphics[width=0.55\textwidth]{img/MARK_II.png}
    \caption{MARK-II system architecture}
    \label{fig:sysarch}
\end{wrapfigure}

On the figure \ref{fig:sysarch} is simple high level schematic of MARK-II system architecture,
you can see bus, CPU and all units. PLL and clock control are only two units
that are not connected to the main BUS. They are don't need any configuration.

PLL unit is generating predefined frequencies, and clock control unit is
generating control signals for clock dividers in other modules.

Another special module is interrupt control unit. It is connected directly to
the CPU and also connected on system BUS. Interrupt control unit have interrupt
sources that are connected to the others modules such are Timers or UARTs.
